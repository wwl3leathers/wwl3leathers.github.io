<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>3Leathers — Custom Request</title>
  <meta name="description" content="Custom leather request form — 3Leathers by Walter Lewis III" />
  <style>
    :root{
      --bg:#0b0b0b; --ink:#f8f5e3; --accent:#d6b14a; --muted:rgba(255,255,255,.08);
      --ok:#3ddc84; --err:#ff6b6b;
    }
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
    a{color:var(--accent);text-decoration:none}
    header{position:sticky;top:0;z-index:10;background:rgba(0,0,0,.6);backdrop-filter:saturate(140%) blur(6px);border-bottom:1px solid var(--muted)}
    .wrap{max-width:980px;margin:auto;padding:16px}
    .row{display:flex;align-items:center;gap:12px;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px}
    .brand img{height:40px;border-radius:4px}
    nav a{margin-left:10px}
    .hero{
      padding:40px 16px;border-bottom:1px solid var(--muted);
      background:linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.7)), url("images/Backdrop2-min.jpeg") center/cover no-repeat;
    }
    .hero h1{margin:0 0 6px 0}
    form{background:rgba(0,0,0,.55);border:1px solid var(--muted);border-radius:14px;padding:20px;margin:24px 0}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .grid-1{grid-template-columns:1fr}
    label{font-weight:600;font-size:14px}
    input[type=text],input[type=email],input[type=tel],input[type=url],select,textarea{
      width:100%;margin-top:6px;padding:10px 12px;border-radius:10px;border:1px solid var(--muted);
      background:#0f0f0f;color:var(--ink);outline:none;
    }
    textarea{min-height:110px;resize:vertical}
    .hint{font-size:12px;opacity:.75}
    .pill{padding:10px 14px;border-radius:999px;background:var(--accent);color:#000;font-weight:700;text-decoration:none;border:none;cursor:pointer}
    .pill.secondary{background:#2a2a2a;color:var(--ink);border:1px solid var(--muted)}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    ul#thread{list-style:none;margin:10px 0 0 0;padding:0}
    ul#thread li{background:#121212;border:1px solid var(--muted);padding:10px;border-radius:10px;margin:8px 0}
    .msg{border-left:3px solid var(--accent);padding-left:10px}
    .req{display:flex;gap:8px;align-items:center;margin-top:10px}
    .req input[type=checkbox]{transform:scale(1.2)}
    .status{margin-top:14px;font-weight:700}
    .ok{color:var(--ok)} .err{color:var(--err)}
    footer{padding:24px 16px;border-top:1px solid var(--muted);text-align:center;color:#cfc8a8}
    @media (max-width:720px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div class="wrap row">
      <div class="brand">
        <img src="images/Logo-min.jpg" alt="3Leathers logo">
        <strong>3Leathers</strong>
      </div>
      <nav aria-label="Primary">
        <a href="index.html">Home</a> •
        <a href="shop.html">Shop</a> •
        <a href="custom.html" aria-current="page"><strong>Custom</strong></a> •
        <a href="checkout.html">Checkout</a>
      </nav>
    </div>
  </header>

  <section class="hero">
    <div class="wrap">
      <h1>Custom Leather Request</h1>
      <p>No machines. Made by hand. Tell me what you have in mind — I’ll take it from there.</p>
    </div>
  </section>

  <main class="wrap">
    <form id="customForm" action="https://formspree.io/f/xvgvjnbe" method="POST" novalidate>
      <!-- Helpful context for Formspree inbox -->
      <input type="hidden" name="_subject" value="New Custom Request — 3Leathers">
      <input type="hidden" name="pageTitle" value="3Leathers — Custom Request">
      <input type="hidden" name="pageURL" value="">

      <!-- Contact + item basics -->
      <div class="grid">
        <div>
          <label for="name">Name *</label>
          <input id="name" name="name" type="text" autocomplete="name" required />
        </div>
        <div>
          <label for="email">Email *</label>
          <input id="email" name="email" type="email" autocomplete="email" required />
        </div>
        <div>
          <label for="phone">Phone (optional)</label>
          <input id="phone" name="phone" type="tel" autocomplete="tel" />
        </div>
        <div>
          <label for="product">Item Type *</label>
          <select id="product" name="product" required>
            <option value="" disabled selected>Select one…</option>
            <option>Wallet</option>
            <option>Purse</option>
            <option>Holster</option>
            <option>Other</option>
          </select>
        </div>
      </div>

      <!-- Options -->
      <div class="grid" style="margin-top:10px">
        <div>
          <label for="leather">Leather Color / Finish</label>
          <input id="leather" name="leather" type="text" placeholder="e.g., dark brown, oil-tan" />
        </div>
        <div class="grid-1">
          <label for="sizing">Sizing / Fit Notes</label>
          <textarea id="sizing" name="sizing" placeholder="Measurements, carry style, wrist size, belt width, etc."></textarea>
        </div>
      </div>

      <!-- Reference link -->
      <div class="grid" style="margin-top:10px">
        <div class="grid-1">
          <label for="referenceUrl">Reference Image Link (optional)</label>
          <input id="referenceUrl" name="referenceUrl" type="url" placeholder="Paste a link to a photo or sketch (Drive, iCloud, Imgur)"/>
          <p class="hint">Tip: Paste any link to a photo — I’ll open it when reviewing your request.</p>
        </div>
      </div>

      <!-- Interactive comments thread -->
      <section style="margin-top:14px">
        <label for="commentInput">Conversation / Notes</label>
        <div class="actions">
          <input id="commentInput" type="text" placeholder="Type a message for Walter…" style="flex:1;min-width:220px" />
          <button id="addMsg" class="pill" type="button">+ Add Message</button>
          <button id="clearMsg" class="pill secondary" type="button">Clear</button>
        </div>
        <ul id="thread" aria-live="polite"></ul>
        <textarea id="conversation" name="conversation" hidden></textarea>
      </section>

      <!-- Consent + honeypot -->
      <div class="req">
        <input id="agree" name="consent" type="checkbox" value="yes" required />
        <label for="agree">I agree that custom work may require a deposit and build time.</label>
      </div>
      <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off" />

      <!-- Submit -->
      <div class="actions" style="margin-top:16px">
        <button class="pill" type="submit">Send Request</button>
        <button class="pill secondary" type="reset">Reset</button>
      </div>

      <div id="status" class="status" role="status" aria-live="polite"></div>
    </form>
  </main>

  <footer>
    <div class="wrap" style="text-align:center">
      <small>&copy; <span id="yr"></span> 3Leathers — Handmade by Walter Lewis III</small>
    </div>
  </footer>

  <script>
    // Page context
    document.getElementById('yr').textContent = new Date().getFullYear();
    const form = document.getElementById('customForm');
    form.querySelector('[name="pageURL"]').value = location.href;

    // Build conversation thread → hidden textarea
    const threadEl = document.getElementById('thread');
    const inputEl  = document.getElementById('commentInput');
    const convoEl  = document.getElementById('conversation');
    const addBtn   = document.getElementById('addMsg');
    const clearBtn = document.getElementById('clearMsg');

    function rebuildConversation(){
      const lines = Array.from(threadEl.querySelectorAll('li .msg')).map(x=>x.textContent.trim());
      convoEl.value = lines.map((t,i)=>`[${String(i+1).padStart(2,'0')}] ${t}`).join('\n');
    }
    addBtn.addEventListener('click', ()=>{
      const txt = (inputEl.value || '').trim();
      if(!txt) return;
      const li = document.createElement('li');
      li.innerHTML = `<div class="msg">${txt}</div>`;
      threadEl.appendChild(li);
      inputEl.value = '';
      rebuildConversation();
      inputEl.focus();
    });
    clearBtn.addEventListener('click', ()=>{
      threadEl.innerHTML = '';
      rebuildConversation();
      inputEl.focus();
    });

    // URL prefill for quick quotes
    (function prefillFromQuery(){
      const p = new URLSearchParams(location.search);
      const map = {
        name: '#name',
        email: '#email',
        phone: '#phone',
        product: '#product',
        leather: '#leather',
        sizing: '#sizing',
        referenceUrl: '#referenceUrl'
      };
      Object.entries(map).forEach(([key, sel])=>{
        if (p.has(key)) {
          const el = document.querySelector(sel);
          if (!el) return;
          el.value = p.get(key);
        }
      });
    })();

    // AJAX submit to Formspree (no page change)
    const status = document.getElementById('status');
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      status.textContent = 'Sending…'; status.className = 'status';
      rebuildConversation();
      const formData = new FormData(form);
      try{
        const resp = await fetch(form.action, { method:'POST', body: formData, headers: { 'Accept': 'application/json' }});
        if (resp.ok) {
          status.textContent = 'Thanks! Your custom request was received.';
          status.classList.add('ok');
          form.reset(); threadEl.innerHTML = ''; convoEl.value = '';
        } else {
          const data = await resp.json().catch(()=>({}));
          const msg = (data && data.errors && data.errors.length) ? data.errors.map(e=>e.message).join(', ') : 'Submission failed.';
          status.textContent = msg + ' Please try again.'; status.classList.add('err');
        }
      } catch(err){
        status.textContent = 'Network error — please try again in a moment.'; status.classList.add('err');
      }
    }, false);
  </script>
</body>
</html>
